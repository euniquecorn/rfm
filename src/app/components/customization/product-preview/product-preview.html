<div class="product-preview">
  <!-- Preview Controls -->
  <div class="preview-controls">
    <button class="control-btn"
            [disabled]="!canUndo()"
            (click)="undo()"
            title="Undo">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M3 7v6h6"></path>
        <path d="M21 17a9 9 0 00-9-9 9 9 0 00-6 2.3L3 13"></path>
      </svg>
    </button>
    <button class="control-btn"
            [disabled]="!canRedo()"
            (click)="redo()"
            title="Redo">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M21 7v6h-6"></path>
        <path d="M3 17a9 9 0 019-9 9 9 0 016 2.3l3-2.3"></path>
      </svg>
    </button>
    <button class="control-btn" (click)="centerDesign()" title="Center Design">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="3"></circle>
        <path d="m3 12 6-6-6-6"></path>
        <path d="m21 12-6-6 6-6"></path>
      </svg>
    </button>
    <button class="control-btn" (click)="resetDesign()" title="Reset Design">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="3,6 5,6 21,6"></polyline>
        <path d="m19,6v14a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6m3,0V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2v2"></path>
      </svg>
    </button>
  </div>

  <!-- T-Shirt Preview -->
  <div class="tshirt-preview">
    <div class="tshirt-container">
      <!-- T-Shirt Base -->
      <div class="tshirt-base" [style.background-color]="selectedColor">
        <!-- T-Shirt Shape -->
        <div class="tshirt-shape">
          <!-- Collar -->
          <div class="collar"></div>
          <!-- Sleeves -->
          <div class="sleeve sleeve-left"></div>
          <div class="sleeve sleeve-right"></div>
          <!-- Body -->
          <div class="body"></div>
        </div>
        
        <!-- Design Area -->
        <div class="design-area"
             (mouseup)="onDesignMouseUp()"
             (mousemove)="onDesignMouseMove($event)">
          <div class="design-bounds">
            <!-- Canvas placeholder when no design is present -->
            <div class="canvas-placeholder" *ngIf="!designImageUrl()">
              <div class="placeholder-content">
                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
                  <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                  <circle cx="8.5" cy="8.5" r="1.5"></circle>
                  <polyline points="21,15 16,10 5,21"></polyline>
                </svg>
                <span class="placeholder-text">Design Area</span>
                <span class="placeholder-subtext">Upload an image or select a template to begin</span>
              </div>
            </div>
            
            <!-- Interactive Design Preview -->
            <div class="design-preview"
                 *ngIf="designImageUrl()"
                 [style.left.%]="designPosition().x"
                 [style.top.%]="designPosition().y"
                 [style.width.%]="designSize().width"
                 [style.height.%]="designSize().height"
                 [class.dragging]="isDragging()"
                 [class.resizing]="isResizing()"
                 (mousedown)="onDesignMouseDown($event)">
              <img [src]="designImageUrl()"
                   alt="Design Preview"
                   class="design-image"
                   draggable="false">
              
              <!-- Resize handles -->
              <div class="resize-handles">
                <div class="resize-handle nw"
                     (mousedown)="onDesignResize('nw', $event)"></div>
                <div class="resize-handle ne"
                     (mousedown)="onDesignResize('ne', $event)"></div>
                <div class="resize-handle sw"
                     (mousedown)="onDesignResize('sw', $event)"></div>
                <div class="resize-handle se"
                     (mousedown)="onDesignResize('se', $event)"></div>
              </div>
              
              <!-- Design info overlay -->
              <div class="design-info">
                <span class="size-info">{{ designSize().width.toFixed(0) }}% Ã— {{ designSize().height.toFixed(0) }}%</span>
              </div>
            </div>
            
            <!-- Grid overlay for alignment -->
            <div class="grid-overlay" *ngIf="designImageUrl()">
              <div class="grid-line vertical" style="left: 25%"></div>
              <div class="grid-line vertical" style="left: 50%"></div>
              <div class="grid-line vertical" style="left: 75%"></div>
              <div class="grid-line horizontal" style="top: 25%"></div>
              <div class="grid-line horizontal" style="top: 50%"></div>
              <div class="grid-line horizontal" style="top: 75%"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- View Switcher -->
  <div class="view-switcher">
    <button 
      *ngFor="let view of views()" 
      class="view-btn"
      [class.active]="view.isActive"
      (click)="selectView(view.id)">
      {{ view.name }}
    </button>
  </div>
</div>